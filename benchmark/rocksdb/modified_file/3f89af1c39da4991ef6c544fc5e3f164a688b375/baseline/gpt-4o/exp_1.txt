修改后的函数将工厂对象的创建提前并统一复用collector对象，通过重构和减少冗余代码来提高测试逻辑的清晰度和执行效率。