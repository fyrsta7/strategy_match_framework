修改后的函数通过精简和重构范围边界的判断逻辑、重排日志和文件管理的代码顺序，删减冗余分支，使代码更加清晰、健壮且易于维护。