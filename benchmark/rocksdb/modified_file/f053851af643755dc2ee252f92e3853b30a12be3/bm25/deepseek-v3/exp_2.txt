这个修改将判断是否存在祖父层的逻辑提前并用早期返回方式，避免了在没有祖父层时不必要的区间计算，从而提高了代码效率和可读性。