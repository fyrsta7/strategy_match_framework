一句总结：该修改将求祖父层级的逻辑独立出来，并增加了提前越界判断，从而提升了代码的健壮性和可读性。